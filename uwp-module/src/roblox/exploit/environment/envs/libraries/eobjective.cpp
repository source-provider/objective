#include <roblox/exploit/environment/environment.h>
#include <roblox/exploit/classes/bytecode/bytecode.h>
#include <dependencies/luau/vm/src/lstate.h>
#include <dependencies/luau/vm/src/lapi.h>
#include <dependencies/luau/vm/src/lgc.h>
#include <lualib.h>


/* registering */
static const luaL_Reg envFuncs[] = {
	{NULL, NULL}
};

auto module::environment::createObjective(lua_State* L) -> void {
	const char* defaultName = obfuscate_str("object");
	lua_newtable(L);
	luaL_register(L, NULL, envFuncs);

	lua_setreadonly(L, -1, true);
	lua_setglobal(L, defaultName);

	/* aliases */
	lua_getglobal(L, defaultName);
	lua_setglobal(L, obfuscate_str("syn"));

	lua_getglobal(L, defaultName);
	lua_setglobal(L, obfuscate_str("krnl"));

	lua_getglobal(L, defaultName);
	lua_setglobal(L, obfuscate_str("fluxus"));

	lua_getglobal(L, defaultName);
	lua_setglobal(L, obfuscate_str("oxygen"));

	lua_getglobal(L, defaultName);
	lua_setglobal(L, obfuscate_str("Nihon"));
}